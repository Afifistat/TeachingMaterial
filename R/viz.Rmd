Data visualisation
===

# Base graphics

## Painters model

Graphical elements are added to the canvas one layer at a time, and
the picture builds up in levels. Lower levels are obscured by higher
levels, allowing for blending, masking and overlaying of objects.

```{r}
plot(1:10, 1:10)
rect(2, 2, 8, 8, col = "black")
rect(3, 3, 7, 7, col = "white")
```
## High level plotting functions

High level plotting functions produce an appropriate chart based on
the input.

- `plot`: generic plotting function. By default produces scatterplots
  but other `type`s can be set.
- `barbplot`.
- `boxplot`.
- histograms: `hist`.
- `pie` (not recommended).
- `image` and `heatmap`.

## Low level interaction

Low level interaction with the drawing device to build up a figure piece by piece.

- `points`, `lines`, `curves`, `rect`, `arrows`, `axis`, `abline`, ...

## Numerous parameters to be tuned.

- See `par`:
  - margins (`mar`, ...), grid of figures (`mfrow` and `mfcol`), ...
  - `las`: axes label style
- Arbitrary graph `layout`
- Point symbols (plotting character): `pch`
- Symbol sizes (character expansion): `cex`
- ...

## Adding text on graphs
- `title`: for main and sub-titles
- `mtext`: margin text
- `text`: text at `x` and `y` positions
- `legend`

## Devices

By default, the figures are produced on the screen device
(`dev.new()`). Other devices can be opened prior to plotting: `pdf`,
`postscript`, `png`, `jpeg`, `svg`, ... each with their respective
options including a file name. After plotting, the device must be
closed with `dev.off()`.

```{r, eval=FALSE}
pdf("fig.pdf")
plot(1:10)
dev.off()
```

It is possible to open multiple devices and navigate them with
`dev.prev()`, `dev.next()` and `dev.set(n)`. If a screen device is
open, its content can be copied into another file device with
`dev.copy()`, `dev.copy2pdf()`, ...

## Colours

- Colours can be set by their names (see `colors()`) or by the RGB
  (red, green, blue) specification (as hexadecimals). The `scales`
  package `col2hcl` allows to translate any colour to its RGB
  hexadecimal values. In addition, a fourth (0 <= `alpha`<= 1 in
  `col2hcl`) channel defines transparency (`FF` is opaque, `00` is
  completely transparent).

```{r}
library("scales")
cl <- col2hcl("steelblue", alpha = .1)
x <- rnorm(3e3)
y <- rnorm(3e3)
plot(x, y, pch = 19, col = cl, cex = 2)
```

- The `smoothScatter` function can be used to use colour density to
  represent point density

```{r}
smoothScatter(x, y)
```

- Colour palettes: `rainbow(n)`, `heat.colors(n)`,
`terrain.colours(n)`, `topo.colors(n)`, `cm.colors(n)` or using
`colorRampPalette`:

```{r}
brblramp <- colorRampPalette(c("brown", "steelblue"))
par(mfrow = c(2, 2))
plot(1:10, pch = 19, col = rainbow(10), cex = 3)
plot(1:10, pch = 19, col = cm.colors(10), cex = 3)
plot(1:10, pch = 19, col = heat.colors(10), cex = 3)
plot(1:10, pch = 19, col = brblramp(10), cex = 3)
```

- The `RColorBrewer` package provides a series of well defined colour
  palettes for maximal discrimination, paired data, ...

```{r}
library("RColorBrewer")
display.brewer.all()
```

## Other
- `locator` to obtain the `x` and `y` from a mouse click.
- `identify` to identify index of label of the clostest point to a mouse click.

# `ggplot2`

Based on the **Grammar of Graphics**
- A plot is made up of multiple layers
- A layer consists of *data*, a set of *mappings* between variables
  and *aesthetics* (`aes`), a *geometric object* (`geom`) and a
  *statistical transformation*
- Scales control the details of the mapping
- All components are independant and reusable

```{r}
library("camweather")
d <- nounits(weatherdata("2013-06-01"))
library("ggplot2")
p <- ggplot(data = d, aes(x = Time, y = Temp))
p + geom_point() ## add a layer of points 
p <- ggplot(data = d, aes(x = Time, y = Temp, colour = WindDr))
p + geom_point(size = 3) 
p <- ggplot(data = d, aes(x = Time, y = Temp, colour = WindDr, size = WindSp))
p + geom_point() 
```



See also [these `ggplot2` slides](https://github.com/lgatto/visualisation).

# `lattice`

# Interactive visualisation

- `svg` device
- [`shiny`](http://www.rstudio.com/shiny/)
- [`googleVis`](http://code.google.com/p/google-motion-charts-with-r/)
- [`rCharts`](http://rcharts.io/)

# Resources

- `ggplot2` [web page](http://ggplot2.org/) and [book](http://www.amazon.com/dp/0387981403) (slightly outdated though).
- [R Graphics Cookbook](http://www.amazon.com/dp/1449316956).
- [R Graphics](https://www.stat.auckland.ac.nz/~paul/RG2e/) book.
- [Lattice: Multivariate Data Visualization with R](http://lmdvr.r-forge.r-project.org/figures/figures.html) book.
- [R Graphical Manual](http://rgm3.lab.nig.ac.jp/RGM/)
